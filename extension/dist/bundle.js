(()=>{"use strict";function e(){const e=["article","main",'[role="main"]',".article-content",".post-content",".entry-content",".content"];let t=null;for(const n of e)if(t=document.querySelector(n),t)break;t||(t=document.body);const n=t.cloneNode(!0);n.querySelectorAll("script, style, nav, footer").forEach(e=>e.remove());let o=n.textContent||"";return o=o.replace(/\s+/g," ").replace(/\n+/g,"\n").trim(),o.substring(0,5e3)}chrome.runtime.onMessage.addListener((t,n,o)=>{const c=t;return"getArticleText"===c?.action?o({text:e(),metadata:{title:document.title||"",url:window.location.href,description:document.querySelector('meta[name="description"]')?.getAttribute("content")||""},success:!0}):"openSidePanel"===c?.action&&(chrome.runtime.sendMessage({action:"openSidePanel"}),o({success:!0})),!0}),window.addEventListener("load",()=>{const t=e();t.length>100&&chrome.runtime.sendMessage({action:"articleDetected",text:t},e=>{chrome.runtime.lastError&&console.log("Extension context invalidated")})})})();